"use strict";function report(t,e,r,n,o){var a="pdf"===o?"txt":o;return a="csvp"==o?"csv":a,r=path.join(config.plantillas[a],r+"."+a),new Promise(function(a,l){"pdf"===o?(r=r.replace(".pdf",".txt"),plantilla.read(r).then(replaceVars(e)).then(function(e){buildTable("txt",t,n,"txt",e).then(function(t){toPdf(t).then(function(t){a(t)})})})["catch"](onError)):"docx"===o?toHtml(r).then(replaceVars(e)).then(function(e){buildTable("html",t,n,"docx",e).then(function(t){toDocx(t).then(function(t){a(t)})})})["catch"](onError):"txt"===o?plantilla.read(r).then(replaceVars(e)).then(function(e){buildTable("txt",t,n,"txt",e).then(function(t){a(t)})})["catch"](onError):plantilla.read(r).then(replaceVars(e)).then(function(e){buildTable("csv",t,n,o,e).then(function(t){a(t)})})["catch"](onError)})}function onError(t){console.log(JSON.stringify(t))}var path=require("path"),toHtml=require("./toHtml"),config=require("./config.json"),dataset=require("./dataset.js"),buildTable=require("./buildTable.js"),styles=require("./styles.js"),toPdf=require("./toPdf.js"),toDocx=require("./toDocx.js"),replaceVars=require("./replaceVars.js"),plantilla=require("./plantilla.js");module.exports=report;